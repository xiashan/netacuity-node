import t from"dgram";import e from"crypto";function n(t,e,n,r,i,u,o){try{var a=t[u](o),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(i,u){var o=t.apply(e,r);function a(t){n(o,i,u,a,l,"next",t)}function l(t){n(o,i,u,a,l,"throw",t)}a(void 0)}))}}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},u={exports:{}};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}var a=u.exports=function(){var t={VERSION:"0.8.0",not:{},all:{},any:{}},e=Object.prototype.toString,n=Array.prototype.slice,r=Object.prototype.hasOwnProperty;function u(t){return function(){return!t.apply(null,n.call(arguments))}}function o(t){return function(){for(var e=c(arguments),n=e.length,r=0;r<n;r++)if(!t.call(null,e[r]))return!1;return!0}}function a(t){return function(){for(var e=c(arguments),n=e.length,r=0;r<n;r++)if(t.call(null,e[r]))return!0;return!1}}var l={"<":function(t,e){return t<e},"<=":function(t,e){return t<=e},">":function(t,e){return t>e},">=":function(t,e){return t>=e}};function s(t,e){var n=e+"",r=+(n.match(/\d+/)||NaN),i=n.match(/^[<>]=?|/)[0];return l[i]?l[i](t,r):t==r||r!=r}function c(e){var r=n.call(e);return 1===r.length&&t.array(r[0])&&(r=r[0]),r}t.arguments=function(t){return"[object Arguments]"===e.call(t)||null!=t&&"object"==typeof t&&"callee"in t},t.array=Array.isArray||function(t){return"[object Array]"===e.call(t)},t.boolean=function(t){return!0===t||!1===t||"[object Boolean]"===e.call(t)},t.char=function(e){return t.string(e)&&1===e.length},t.date=function(t){return"[object Date]"===e.call(t)},t.domNode=function(e){return t.object(e)&&e.nodeType>0},t.error=function(t){return"[object Error]"===e.call(t)},t.function=function(t){return"[object Function]"===e.call(t)||"function"==typeof t},t.json=function(t){return"[object Object]"===e.call(t)},t.nan=function(t){return t!=t},t.null=function(t){return null===t},t.number=function(n){return t.not.nan(n)&&"[object Number]"===e.call(n)},t.object=function(t){return Object(t)===t},t.regexp=function(t){return"[object RegExp]"===e.call(t)},t.sameType=function(n,r){var i=e.call(n);return i===e.call(r)&&("[object Number]"!==i||!t.any.nan(n,r)||t.all.nan(n,r))},t.sameType.api=["not"],t.string=function(t){return"[object String]"===e.call(t)},t.undefined=function(t){return void 0===t},t.windowObject=function(t){return null!=t&&"object"==typeof t&&"setInterval"in t},t.empty=function(e){if(t.object(e)){var n=Object.getOwnPropertyNames(e).length;return!!(0===n||1===n&&t.array(e)||2===n&&t.arguments(e))}return""===e},t.existy=function(t){return null!=t},t.falsy=function(t){return!t},t.truthy=u(t.falsy),t.above=function(e,n){return t.all.number(e,n)&&e>n},t.above.api=["not"],t.decimal=function(e){return t.number(e)&&e%1!=0},t.equal=function(e,n){return t.all.number(e,n)?e===n&&1/e==1/n:t.all.string(e,n)||t.all.regexp(e,n)?""+e==""+n:!!t.all.boolean(e,n)&&e===n},t.equal.api=["not"],t.even=function(e){return t.number(e)&&e%2==0},t.finite=isFinite||function(e){return t.not.infinite(e)&&t.not.nan(e)},t.infinite=function(t){return t===1/0||t===-1/0},t.integer=function(e){return t.number(e)&&e%1==0},t.negative=function(e){return t.number(e)&&e<0},t.odd=function(e){return t.number(e)&&e%2==1},t.positive=function(e){return t.number(e)&&e>0},t.under=function(e,n){return t.all.number(e,n)&&e<n},t.under.api=["not"],t.within=function(e,n,r){return t.all.number(e,n,r)&&e>n&&e<r},t.within.api=["not"];var f={affirmative:/^(?:1|t(?:rue)?|y(?:es)?|ok(?:ay)?)$/,alphaNumeric:/^[A-Za-z0-9]+$/,caPostalCode:/^(?!.*[DFIOQU])[A-VXY][0-9][A-Z]\s?[0-9][A-Z][0-9]$/,creditCard:/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/,dateString:/^(1[0-2]|0?[1-9])([\/-])(3[01]|[12][0-9]|0?[1-9])(?:\2)(?:[0-9]{2})?[0-9]{2}$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,eppPhone:/^\+[0-9]{1,3}\.[0-9]{4,14}(?:x.+)?$/,hexadecimal:/^(?:0x)?[0-9a-fA-F]+$/,hexColor:/^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,ipv4:/^(?:(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])$/,ipv6:/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,nanpPhone:/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,socialSecurityNumber:/^(?!000|666)[0-8][0-9]{2}-?(?!00)[0-9]{2}-?(?!0000)[0-9]{4}$/,timeString:/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/,ukPostCode:/^[A-Z]{1,2}[0-9RCHNQ][0-9A-Z]?\s?[0-9][ABD-HJLNP-UW-Z]{2}$|^[A-Z]{2}-?[0-9]{4}$/,url:/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i,usZipCode:/^[0-9]{5}(?:-[0-9]{4})?$/};function d(e,n){t[e]=function(t){return n[e].test(t)}}for(var p in f)f.hasOwnProperty(p)&&d(p,f);t.ip=function(e){return t.ipv4(e)||t.ipv6(e)},t.capitalized=function(e){if(t.not.string(e))return!1;for(var n=e.split(" "),r=0;r<n.length;r++){var i=n[r];if(i.length){var u=i.charAt(0);if(u!==u.toUpperCase())return!1}}return!0},t.endWith=function(e,n){if(t.not.string(e))return!1;n+="";var r=e.length-n.length;return r>=0&&e.indexOf(n,r)===r},t.endWith.api=["not"],t.include=function(t,e){return t.indexOf(e)>-1},t.include.api=["not"],t.lowerCase=function(e){return t.string(e)&&e===e.toLowerCase()},t.palindrome=function(e){if(t.not.string(e))return!1;for(var n=(e=e.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase()).length-1,r=0,i=Math.floor(n/2);r<=i;r++)if(e.charAt(r)!==e.charAt(n-r))return!1;return!0},t.space=function(e){if(t.not.char(e))return!1;var n=e.charCodeAt(0);return n>8&&n<14||32===n},t.startWith=function(e,n){return t.string(e)&&0===e.indexOf(n)},t.startWith.api=["not"],t.upperCase=function(e){return t.string(e)&&e===e.toUpperCase()};var h=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],g=["january","february","march","april","may","june","july","august","september","october","november","december"];t.day=function(e,n){return t.date(e)&&n.toLowerCase()===h[e.getDay()]},t.day.api=["not"],t.dayLightSavingTime=function(t){var e=new Date(t.getFullYear(),0,1),n=new Date(t.getFullYear(),6,1),r=Math.max(e.getTimezoneOffset(),n.getTimezoneOffset());return t.getTimezoneOffset()<r},t.future=function(e){var n=new Date;return t.date(e)&&e.getTime()>n.getTime()},t.inDateRange=function(e,n,r){if(t.not.date(e)||t.not.date(n)||t.not.date(r))return!1;var i=e.getTime();return i>n.getTime()&&i<r.getTime()},t.inDateRange.api=["not"],t.inLastMonth=function(e){return t.inDateRange(e,new Date((new Date).setMonth((new Date).getMonth()-1)),new Date)},t.inLastWeek=function(e){return t.inDateRange(e,new Date((new Date).setDate((new Date).getDate()-7)),new Date)},t.inLastYear=function(e){return t.inDateRange(e,new Date((new Date).setFullYear((new Date).getFullYear()-1)),new Date)},t.inNextMonth=function(e){return t.inDateRange(e,new Date,new Date((new Date).setMonth((new Date).getMonth()+1)))},t.inNextWeek=function(e){return t.inDateRange(e,new Date,new Date((new Date).setDate((new Date).getDate()+7)))},t.inNextYear=function(e){return t.inDateRange(e,new Date,new Date((new Date).setFullYear((new Date).getFullYear()+1)))},t.leapYear=function(e){return t.number(e)&&(e%4==0&&e%100!=0||e%400==0)},t.month=function(e,n){return t.date(e)&&n.toLowerCase()===g[e.getMonth()]},t.month.api=["not"],t.past=function(e){var n=new Date;return t.date(e)&&e.getTime()<n.getTime()},t.quarterOfYear=function(e,n){return t.date(e)&&t.number(n)&&n===Math.floor((e.getMonth()+3)/3)},t.quarterOfYear.api=["not"],t.today=function(e){var n=(new Date).toDateString();return t.date(e)&&e.toDateString()===n},t.tomorrow=function(e){var n=new Date,r=new Date(n.setDate(n.getDate()+1)).toDateString();return t.date(e)&&e.toDateString()===r},t.weekend=function(e){return t.date(e)&&(6===e.getDay()||0===e.getDay())},t.weekday=u(t.weekend),t.year=function(e,n){return t.date(e)&&t.number(n)&&n===e.getFullYear()},t.year.api=["not"],t.yesterday=function(e){var n=new Date,r=new Date(n.setDate(n.getDate()-1)).toDateString();return t.date(e)&&e.toDateString()===r};var F=t.windowObject("object"==typeof i&&i)&&i,m=t.windowObject("object"==typeof self&&self)&&self,y=t.windowObject("object"==typeof this&&this)&&this,w=F||m||y||Function("return this")(),b=m&&m.document,v=w.is,x=m&&m.navigator,D=(x&&x.appVersion||"").toLowerCase(),_=(x&&x.userAgent||"").toLowerCase(),A=(x&&x.vendor||"").toLowerCase();function E(){var e=t;for(var n in e)if(r.call(e,n)&&t.function(e[n]))for(var i=e[n].api||["not","all","any"],l=0;l<i.length;l++)"not"===i[l]&&(t.not[n]=u(t[n])),"all"===i[l]&&(t.all[n]=o(t[n])),"any"===i[l]&&(t.any[n]=a(t[n]))}return t.android=function(){return/android/.test(_)},t.android.api=["not"],t.androidPhone=function(){return/android/.test(_)&&/mobile/.test(_)},t.androidPhone.api=["not"],t.androidTablet=function(){return/android/.test(_)&&!/mobile/.test(_)},t.androidTablet.api=["not"],t.blackberry=function(){return/blackberry/.test(_)||/bb10/.test(_)},t.blackberry.api=["not"],t.chrome=function(t){var e=/google inc/.test(A)?_.match(/(?:chrome|crios)\/(\d+)/):null;return null!==e&&s(e[1],t)},t.chrome.api=["not"],t.desktop=function(){return t.not.mobile()&&t.not.tablet()},t.desktop.api=["not"],t.edge=function(t){var e=_.match(/edge\/(\d+)/);return null!==e&&s(e[1],t)},t.edge.api=["not"],t.firefox=function(t){var e=_.match(/(?:firefox|fxios)\/(\d+)/);return null!==e&&s(e[1],t)},t.firefox.api=["not"],t.ie=function(t){var e=_.match(/(?:msie |trident.+?; rv:)(\d+)/);return null!==e&&s(e[1],t)},t.ie.api=["not"],t.ios=function(){return t.iphone()||t.ipad()||t.ipod()},t.ios.api=["not"],t.ipad=function(t){var e=_.match(/ipad.+?os (\d+)/);return null!==e&&s(e[1],t)},t.ipad.api=["not"],t.iphone=function(t){var e=_.match(/iphone(?:.+?os (\d+))?/);return null!==e&&s(e[1]||1,t)},t.iphone.api=["not"],t.ipod=function(t){var e=_.match(/ipod.+?os (\d+)/);return null!==e&&s(e[1],t)},t.ipod.api=["not"],t.linux=function(){return/linux/.test(D)},t.linux.api=["not"],t.mac=function(){return/mac/.test(D)},t.mac.api=["not"],t.mobile=function(){return t.iphone()||t.ipod()||t.androidPhone()||t.blackberry()||t.windowsPhone()},t.mobile.api=["not"],t.offline=u(t.online),t.offline.api=["not"],t.online=function(){return!x||!0===x.onLine},t.online.api=["not"],t.opera=function(t){var e=_.match(/(?:^opera.+?version|opr)\/(\d+)/);return null!==e&&s(e[1],t)},t.opera.api=["not"],t.phantom=function(t){var e=_.match(/phantomjs\/(\d+)/);return null!==e&&s(e[1],t)},t.phantom.api=["not"],t.safari=function(t){var e=_.match(/version\/(\d+).+?safari/);return null!==e&&s(e[1],t)},t.safari.api=["not"],t.tablet=function(){return t.ipad()||t.androidTablet()||t.windowsTablet()},t.tablet.api=["not"],t.touchDevice=function(){return!!b&&("ontouchstart"in m||"DocumentTouch"in m&&b instanceof DocumentTouch)},t.touchDevice.api=["not"],t.windows=function(){return/win/.test(D)},t.windows.api=["not"],t.windowsPhone=function(){return t.windows()&&/phone/.test(_)},t.windowsPhone.api=["not"],t.windowsTablet=function(){return t.windows()&&t.not.windowsPhone()&&/touch/.test(_)},t.windowsTablet.api=["not"],t.propertyCount=function(e,n){if(t.not.object(e)||t.not.number(n))return!1;var i=0;for(var u in e)if(r.call(e,u)&&++i>n)return!1;return i===n},t.propertyCount.api=["not"],t.propertyDefined=function(e,n){return t.object(e)&&t.string(n)&&n in e},t.propertyDefined.api=["not"],t.inArray=function(e,n){if(t.not.array(n))return!1;for(var r=0;r<n.length;r++)if(n[r]===e)return!0;return!1},t.inArray.api=["not"],t.sorted=function(e,n){if(t.not.array(e))return!1;for(var r=l[n]||l[">="],i=1;i<e.length;i++)if(!r(e[i],e[i-1]))return!1;return!0},E(),t.setNamespace=function(){return w.is=v,this},t.setRegexp=function(t,e){for(var n in f)r.call(f,n)&&e===n&&(f[n]=t)},t}();function l(t){if(!a.existy(t))return null;if(a.not.string(t))throw new TypeError('Expected a string, got "'.concat(o(t),'"'));return t.split(",").map((function(t){var e=t.trim();if(e.includes(":")){var n=e.split(":");if(2===n.length)return n[0]}return e})).find(a.ip)}function s(t){if(t.headers){if(a.ip(t.headers["x-client-ip"]))return t.headers["x-client-ip"];var e=l(t.headers["x-forwarded-for"]);if(a.ip(e))return e;if(a.ip(t.headers["cf-connecting-ip"]))return t.headers["cf-connecting-ip"];if(a.ip(t.headers["fastly-client-ip"]))return t.headers["fastly-client-ip"];if(a.ip(t.headers["true-client-ip"]))return t.headers["true-client-ip"];if(a.ip(t.headers["x-real-ip"]))return t.headers["x-real-ip"];if(a.ip(t.headers["x-cluster-client-ip"]))return t.headers["x-cluster-client-ip"];if(a.ip(t.headers["x-forwarded"]))return t.headers["x-forwarded"];if(a.ip(t.headers["forwarded-for"]))return t.headers["forwarded-for"];if(a.ip(t.headers.forwarded))return t.headers.forwarded}if(a.existy(t.connection)){if(a.ip(t.connection.remoteAddress))return t.connection.remoteAddress;if(a.existy(t.connection.socket)&&a.ip(t.connection.socket.remoteAddress))return t.connection.socket.remoteAddress}return a.existy(t.socket)&&a.ip(t.socket.remoteAddress)?t.socket.remoteAddress:a.existy(t.info)&&a.ip(t.info.remoteAddress)?t.info.remoteAddress:a.existy(t.requestContext)&&a.existy(t.requestContext.identity)&&a.ip(t.requestContext.identity.sourceIp)?t.requestContext.identity.sourceIp:null}var c={getClientIpFromXForwardedFor:l,getClientIp:s,mw:function(t){var e=a.not.existy(t)?{}:t;if(a.not.object(e))throw new TypeError("Options must be an object!");var n=e.attributeName||"clientIp";return function(t,e,r){var i=s(t);Object.defineProperty(t,n,{get:function(){return i},configurable:!0}),r()}}},f={},d={},p={},h="abcdefghijklmnopqrstuvwxyz",g=h.toUpperCase(),F=/[0OIl]/gi;p.generate=function(t,e){var n;return n="alphanumeric"===t?"0123456789"+h+g:"numeric"===t?"0123456789":"alphabetic"===t?h+g:"hex"===t?"0123456789abcdef":t,e&&(n=n.replace(F,"")),n};var m=e,y=p;d.generate=function(t){var e,n,r="";for("object"==typeof t?(e=t.length||32,n=t.charset?y.generate(t.charset,t.readable):y.generate("alphanumeric",t.readable)):"number"==typeof t?(e=t,n=y.generate("alphanumeric")):(e=32,n=y.generate("alphanumeric"));r.length<e;){var i;try{i=m.randomBytes(e)}catch(t){continue}for(var u=0;u<i.length;u++){var o=i.readUInt8(u)%n.length;r+=n.charAt(o)}}return r};var w=d,b={},v={exports:{}},x=v.exports=function(t){var e=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,n=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,r=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,i=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i,u=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF\s]*<(.+)>$/i,o=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,a=/^[A-Z]{2}[0-9A-Z]{9}[0-9]$/,l=/^(?:[0-9]{9}X|[0-9]{10})$/,s=/^(?:[0-9]{13})$/,c=/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/,f=/^[0-9A-F]{1,4}$/i,d={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i},p=/^[A-Z]+$/i,h=/^[0-9A-Z]+$/i,g=/^[-+]?[0-9]+$/,F=/^(?:[-+]?(?:0|[1-9][0-9]*))$/,m=/^(?:[-+]?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/,y=/^[0-9A-F]+$/i,w=/^[-+]?([0-9]+|\.[0-9]+|[0-9]+\.[0-9]+)$/,b=/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i,v=/^[\x00-\x7F]+$/,x=/[^\x00-\x7F]/,D=/[^\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,_=/[\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,A=/[\uD800-\uDBFF][\uDC00-\uDFFF]/,E=/^(?:[A-Z0-9+\/]{4})*(?:[A-Z0-9+\/]{2}==|[A-Z0-9+\/]{3}=|[A-Z0-9+\/]{4})$/i,$={"zh-CN":/^(\+?0?86\-?)?1[345789]\d{9}$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-HK":/^(\+?852\-?)?[569]\d{3}\-?\d{4}$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"pt-PT":/^(\+351)?9[1236]\d{7}$/,"el-GR":/^(\+30)?((2\d{9})|(69\d{8}))$/,"en-GB":/^(\+?44|0)7\d{9}$/,"en-US":/^(\+?1)?[2-9]\d{2}[2-9](?!11)\d{6}$/,"en-ZM":/^(\+26)?09[567]\d{7}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/},R=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;(t={version:"4.1.0"}).extend=function(e,n){t[e]=function(){var e=Array.prototype.slice.call(arguments);return e[0]=t.toString(e[0]),n.apply(t,e)}},t.init=function(){for(var e in t)"function"==typeof t[e]&&"toString"!==e&&"toDate"!==e&&"extend"!==e&&"init"!==e&&t.extend(e,t[e])},t.toString=function(t){return"object"==typeof t&&null!==t&&t.toString?t=t.toString():null==t||isNaN(t)&&!t.length?t="":"string"!=typeof t&&(t+=""),t},t.toDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)?t:(t=Date.parse(t),isNaN(t)?null:new Date(t))},t.toFloat=function(t){return parseFloat(t)},t.toInt=function(t,e){return parseInt(t,e||10)},t.toBoolean=function(t,e){return e?"1"===t||"true"===t:"0"!==t&&"false"!==t&&""!==t},t.equals=function(e,n){return e===t.toString(n)},t.contains=function(e,n){return e.indexOf(t.toString(n))>=0},t.matches=function(t,e,n){return"[object RegExp]"!==Object.prototype.toString.call(e)&&(e=new RegExp(e,n)),e.test(t)};var C={allow_display_name:!1,allow_utf8_local_part:!0,require_tld:!0};t.isEmail=function(o,a){if((a=k(a,C)).allow_display_name){var l=o.match(u);l&&(o=l[1])}var s=o.split("@"),c=s.pop(),f=s.join("@"),d=c.toLowerCase();if("gmail.com"!==d&&"googlemail.com"!==d||(f=f.replace(/\./g,"").toLowerCase()),!t.isByteLength(f,0,64)||!t.isByteLength(c,0,256))return!1;if(!t.isFQDN(c,{require_tld:a.require_tld}))return!1;if('"'===f[0])return f=f.slice(1,f.length-1),a.allow_utf8_local_part?i.test(f):n.test(f);for(var p=a.allow_utf8_local_part?r:e,h=f.split("."),g=0;g<h.length;g++)if(!p.test(h[g]))return!1;return!0};var O={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1};t.isURL=function(e,n){if(!e||e.length>=2083||/\s/.test(e))return!1;if(0===e.indexOf("mailto:"))return!1;var r,i,u,o,a,l,s;if(n=k(n,O),(s=e.split("://")).length>1){if(r=s.shift(),n.require_valid_protocol&&-1===n.protocols.indexOf(r))return!1}else{if(n.require_protocol)return!1;n.allow_protocol_relative_urls&&"//"===e.substr(0,2)&&(s[0]=e.substr(2))}return e=s.join("://"),s=e.split("#"),e=s.shift(),s=e.split("?"),e=s.shift(),s=e.split("/"),e=s.shift(),!((s=e.split("@")).length>1&&(i=s.shift()).indexOf(":")>=0&&i.split(":").length>2||(o=s.join("@"),u=(s=o.split(":")).shift(),s.length&&(l=s.join(":"),a=parseInt(l,10),!/^[0-9]+$/.test(l)||a<=0||a>65535)||!t.isIP(u)&&!t.isFQDN(u,n)&&"localhost"!==u||n.host_whitelist&&-1===n.host_whitelist.indexOf(u)||n.host_blacklist&&-1!==n.host_blacklist.indexOf(u)))},t.isIP=function(e,n){if(!(n=t.toString(n)))return t.isIP(e,4)||t.isIP(e,6);if("4"===n)return!!c.test(e)&&e.split(".").sort((function(t,e){return t-e}))[3]<=255;if("6"===n){var r=e.split(":"),i=!1,u=t.isIP(r[r.length-1],4),o=u?7:8;if(r.length>o)return!1;if("::"===e)return!0;"::"===e.substr(0,2)?(r.shift(),r.shift(),i=!0):"::"===e.substr(e.length-2)&&(r.pop(),r.pop(),i=!0);for(var a=0;a<r.length;++a)if(""===r[a]&&a>0&&a<r.length-1){if(i)return!1;i=!0}else if(u&&a==r.length-1);else if(!f.test(r[a]))return!1;return i?r.length>=1:r.length===o}return!1};var j={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1};t.isFQDN=function(t,e){(e=k(e,j)).allow_trailing_dot&&"."===t[t.length-1]&&(t=t.substring(0,t.length-1));var n=t.split(".");if(e.require_tld){var r=n.pop();if(!n.length||!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(r))return!1}for(var i,u=0;u<n.length;u++){if(i=n[u],e.allow_underscores){if(i.indexOf("__")>=0)return!1;i=i.replace(/_/g,"")}if(!/^[a-z\u00a1-\uffff0-9-]+$/i.test(i))return!1;if(/[\uff01-\uff5e]/.test(i))return!1;if("-"===i[0]||"-"===i[i.length-1]||i.indexOf("---")>=0)return!1}return!0},t.isBoolean=function(t){return["true","false","1","0"].indexOf(t)>=0},t.isAlpha=function(t){return p.test(t)},t.isAlphanumeric=function(t){return h.test(t)},t.isNumeric=function(t){return g.test(t)},t.isDecimal=function(t){return""!==t&&w.test(t)},t.isHexadecimal=function(t){return y.test(t)},t.isHexColor=function(t){return b.test(t)},t.isLowercase=function(t){return t===t.toLowerCase()},t.isUppercase=function(t){return t===t.toUpperCase()},t.isInt=function(t,e){return e=e||{},F.test(t)&&(!e.hasOwnProperty("min")||t>=e.min)&&(!e.hasOwnProperty("max")||t<=e.max)},t.isFloat=function(t,e){return e=e||{},""!==t&&m.test(t)&&(!e.hasOwnProperty("min")||t>=e.min)&&(!e.hasOwnProperty("max")||t<=e.max)},t.isDivisibleBy=function(e,n){return t.toFloat(e)%t.toInt(n)==0},t.isNull=function(t){return 0===t.length},t.isLength=function(t,e,n){var r=t.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g)||[],i=t.length-r.length;return i>=e&&(void 0===n||i<=n)},t.isByteLength=function(t,e,n){var r=encodeURI(t).split(/%..|./).length-1;return r>=e&&(void 0===n||r<=n)},t.isUUID=function(t,e){var n=d[e||"all"];return n&&n.test(t)},t.isDate=function(t){var e,n,r,i=new Date(new Date(t).toUTCString()),u=String(i.getDate()),o=String(i.getUTCDate());return!(isNaN(Date.parse(i))||(n=t.match(/(^|[^:\d])[23]\d([^:\d]|$)/g))&&(e=n.map((function(t){return t.match(/\d+/g)[0]})).join("/"),r=String(i.getFullYear()).slice(-2),e!==u&&e!==o&&e!==r&&e!==u+"/"+r&&e!==r+"/"+u&&e!==o+"/"+r&&e!==r+"/"+o))},t.isAfter=function(e,n){var r=t.toDate(n||new Date),i=t.toDate(e);return!!(i&&r&&i>r)},t.isBefore=function(e,n){var r=t.toDate(n||new Date),i=t.toDate(e);return!!(i&&r&&i<r)},t.isIn=function(e,n){var r;if("[object Array]"===Object.prototype.toString.call(n)){var i=[];for(r in n)i[r]=t.toString(n[r]);return i.indexOf(e)>=0}return"object"==typeof n?n.hasOwnProperty(e):!(!n||"function"!=typeof n.indexOf)&&n.indexOf(e)>=0},t.isCreditCard=function(t){var e=t.replace(/[^0-9]+/g,"");if(!o.test(e))return!1;for(var n,r,i,u=0,a=e.length-1;a>=0;a--)n=e.substring(a,a+1),r=parseInt(n,10),u+=i&&(r*=2)>=10?r%10+1:r,i=!i;return!(u%10!=0||!e)},t.isISIN=function(t){if(!a.test(t))return!1;for(var e,n,r=t.replace(/[A-Z]/g,(function(t){return parseInt(t,36)})),i=0,u=!0,o=r.length-2;o>=0;o--)e=r.substring(o,o+1),n=parseInt(e,10),i+=u&&(n*=2)>=10?n+1:n,u=!u;return parseInt(t.substr(t.length-1),10)===(1e4-i)%10},t.isISBN=function(e,n){if(!(n=t.toString(n)))return t.isISBN(e,10)||t.isISBN(e,13);var r,i=e.replace(/[\s-]+/g,""),u=0;if("10"===n){if(!l.test(i))return!1;for(r=0;r<9;r++)u+=(r+1)*i.charAt(r);if("X"===i.charAt(9)?u+=100:u+=10*i.charAt(9),u%11==0)return!!i}else if("13"===n){if(!s.test(i))return!1;var o=[1,3];for(r=0;r<12;r++)u+=o[r%2]*i.charAt(r);if(i.charAt(12)-(10-u%10)%10==0)return!!i}return!1},t.isMobilePhone=function(t,e){return e in $&&$[e].test(t)};var I={symbol:"$",require_symbol:!1,allow_space_after_symbol:!1,symbol_after_digits:!1,allow_negatives:!0,parens_for_negatives:!1,negative_sign_before_digits:!1,negative_sign_after_digits:!1,allow_negative_sign_placeholder:!1,thousands_separator:",",decimal_separator:".",allow_space_after_digits:!1};t.isCurrency=function(t,e){return T(e=k(e,I)).test(t)},t.isJSON=function(t){try{var e=JSON.parse(t);return!!e&&"object"==typeof e}catch(t){}return!1},t.isMultibyte=function(t){return x.test(t)},t.isAscii=function(t){return v.test(t)},t.isFullWidth=function(t){return D.test(t)},t.isHalfWidth=function(t){return _.test(t)},t.isVariableWidth=function(t){return D.test(t)&&_.test(t)},t.isSurrogatePair=function(t){return A.test(t)},t.isBase64=function(t){return E.test(t)},t.isMongoId=function(e){return t.isHexadecimal(e)&&24===e.length},t.isISO8601=function(t){return R.test(t)},t.ltrim=function(t,e){var n=e?new RegExp("^["+e+"]+","g"):/^\s+/g;return t.replace(n,"")},t.rtrim=function(t,e){var n=e?new RegExp("["+e+"]+$","g"):/\s+$/g;return t.replace(n,"")},t.trim=function(t,e){var n=e?new RegExp("^["+e+"]+|["+e+"]+$","g"):/^\s+|\s+$/g;return t.replace(n,"")},t.escape=function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\`/g,"&#96;")},t.stripLow=function(e,n){var r=n?"\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F":"\\x00-\\x1F\\x7F";return t.blacklist(e,r)},t.whitelist=function(t,e){return t.replace(new RegExp("[^"+e+"]+","g"),"")},t.blacklist=function(t,e){return t.replace(new RegExp("["+e+"]+","g"),"")};var S={lowercase:!0};function k(t,e){for(var n in t=t||{},e)void 0===t[n]&&(t[n]=e[n]);return t}function T(t){var e="(\\"+t.symbol.replace(/\./g,"\\.")+")"+(t.require_symbol?"":"?"),n="-?",r="("+["0","[1-9]\\d*","[1-9]\\d{0,2}(\\"+t.thousands_separator+"\\d{3})*"].join("|")+")?(\\"+t.decimal_separator+"\\d{2})?";return t.allow_negatives&&!t.parens_for_negatives&&(t.negative_sign_after_digits?r+=n:t.negative_sign_before_digits&&(r=n+r)),t.allow_negative_sign_placeholder?r="( (?!\\-))?"+r:t.allow_space_after_symbol?r=" ?"+r:t.allow_space_after_digits&&(r+="( (?!$))?"),t.symbol_after_digits?r+=e:r=e+r,t.allow_negatives&&(t.parens_for_negatives?r="(\\("+r+"\\)|"+r+")":t.negative_sign_before_digits||t.negative_sign_after_digits||(r=n+r)),new RegExp("^(?!-? )(?=.*\\d)"+r+"$")}return t.normalizeEmail=function(e,n){if(n=k(n,S),!t.isEmail(e))return!1;var r=e.split("@",2);if(r[1]=r[1].toLowerCase(),"gmail.com"===r[1]||"googlemail.com"===r[1]){if(r[0]=r[0].toLowerCase().replace(/\./g,""),"+"===r[0][0])return!1;r[0]=r[0].split("+")[0],r[1]="gmail.com"}else n.lowercase&&(r[0]=r[0].toLowerCase());return r.join("@")},t.init(),t}(),D={ERROR:"Service Error",TIMEOUT:"Request timed out for transaction %s",IDENTIFY_ERROR:"Transaction id not match",SERVICE_ERROR:"NetAcuity service error %s",PARAM_ERROR:"Params Error"},_={geo:3,edge:4,sic:5,domain:6,zip:7,isp:8,home_biz:9,asn:10,language:11,proxy:12,isAnIsp:14,company:15,demographics:17,naics:18,cbsa:19,mobileCarrier:24,organization:25,pulse:26,pulseplus:30};function A(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this.country=null==e[0]?"?":e[0],this.region=null==e[1]?"?":e[1],this.city=null==e[2]?"?":e[2],this["conn-speed"]=null==e[3]?"?":e[3],this["country-conf"]=null==e[4]?0:e[4],this["region-conf"]=null==e[5]?0:e[5],this["city-conf"]=null==e[6]?0:e[6],this["metro-code"]=null==e[7]?0:e[7],this.latitude=null==e[8]?0:e[8],this.longitude=null==e[9]?0:e[9],this["country-code"]=null==e[10]?0:e[10],this["region-code"]=null==e[11]?0:e[11],this["city-code"]=null==e[12]?0:e[12],this["continent-code"]=null==e[13]?0:e[13],this["two-letter-country"]=null==e[14]?"?":e[14]}function E(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["edge-country"]=null==e[0]?"?":e[0],this["edge-region"]=null==e[1]?"?":e[1],this["edge-city"]=null==e[2]?"?":e[2],this["edge-conn-speed"]=null==e[3]?"?":e[3],this["edge-metro-code"]=null==e[4]?0:e[4],this["edge-latitude"]=null==e[5]?0:e[5],this["edge-longitude"]=null==e[6]?0:e[6],this["edge-postal-code"]=null==e[7]?"?":e[7],this["edge-country-code"]=null==e[8]?0:e[8],this["edge-region-code"]=null==e[9]?0:e[9],this["edge-city-code"]=null==e[10]?0:e[10],this["edge-continent-code"]=null==e[11]?0:e[11],this["edge-two-letter-country"]=null==e[12]?"?":e[12],this["edge-internal-code"]=null==e[13]?0:e[13],this["edge-area-codes"]=null==e[14]?"?":e[14],this["edge-country-conf"]=null==e[15]?0:e[15],this["edge-region-conf"]=null==e[16]?0:e[16],this["edge-city-conf"]=null==e[17]?0:e[17],this["edge-postal-conf"]=null==e[18]?0:e[18],this["edge-gmt-offset"]=null==e[19]?0:e[19],this["edge-in-dst"]=null==e[20]?"?":e[20]}function $(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["sic-code"]=null==e[0]?0:e[0]}function R(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["domain-name"]=null==e[0]?"?":e[0]}function C(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["area-code"]=null==e[0]?0:e[0],this["zip-code"]=null==e[1]?0:e[1],this["gmt-offset"]=null==e[2]?0:e[2],this["in-dst"]=null==e[3]?"?":e[3],this["zip-code-text"]=null==e[4]?"?":e[4],this["zip-country"]=null==e[5]?"?":e[5]}function O(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["isp-name"]=null==e[0]?"?":e[0]}function j(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["homebiz-type"]=null==e[0]?"?":e[0]}function I(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this.asn=null==e[0]?0:e[0],this["asn-name"]=null==e[1]?"?":e[1]}function S(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["primary-lang"]=null==e[0]?"?":e[0],this["secondary-lang"]=null==e[1]?"?":e[1]}function k(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["proxy-type"]=null==e[0]?"?":e[0],this["proxy-description"]=null==e[1]?"?":e[1]}function T(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["is-an-isp"]=null==e[0]?"?":e[0]}function z(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["company-name"]=null==e[0]?"?":e[0]}function N(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this.rank=null==e[0]?0:e[0],this.households=null==e[1]?0:e[1],this.women=null==e[2]?0:e[2],this["w18-34"]=null==e[3]?0:e[3],this["w35-49"]=null==e[4]?0:e[4],this.men=null==e[5]?0:e[5],this["m18-34"]=null==e[6]?0:e[6],this["m35-49"]=null==e[7]?0:e[7],this.teens=null==e[8]?0:e[8],this.kids=null==e[9]?0:e[9]}function P(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["naics-code"]=null==e[0]?0:e[0]}function L(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["cbsa-code"]=null==e[0]?0:e[0],this["cbsa-title"]=null==e[1]?"?":e[1],this["cbsa-type"]=null==e[2]?"?":e[2],this["csa-code"]=null==e[3]?0:e[3],this["csa-title"]=null==e[4]?"?":e[4],this["md-code"]=null==e[5]?0:e[5],this["md-title"]=null==e[6]?"?":e[6]}function q(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["mobile-carrier"]=null==e[0]?"?":e[0],this.mcc=null==e[1]?0:e[1],this.mnc=null==e[2]?0:e[2],this["mobile-carrier-code"]=null==e[2]?0:e[3]}function B(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["organization-name"]=null==e[0]?"?":e[0]}function Z(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["pulse-country"]=null==e[0]?"?":e[0],this["pulse-region"]=null==e[1]?"?":e[1],this["pulse-city"]=null==e[2]?"?":e[2],this["pulse-conn-speed"]=null==e[3]?"?":e[3],this["pulse-conn-type"]=null==e[4]?"?":e[4],this["pulse-metro-code"]=null==e[5]?0:e[5],this["pulse-latitude"]=null==e[6]?0:e[6],this["pulse-longitude"]=null==e[7]?0:e[7],this["pulse-postal-code"]=null==e[8]?"?":e[8],this["pulse-country-code"]=null==e[9]?0:e[9],this["pulse-region-code"]=null==e[10]?0:e[10],this["pulse-city-code"]=null==e[11]?0:e[11],this["pulse-continent-code"]=null==e[12]?0:e[12],this["pulse-two-letter-country"]=null==e[13]?"?":e[13],this["pulse-internal-code"]=null==e[14]?0:e[14],this["pulse-area-codes"]=null==e[15]?"?":e[15],this["pulse-country-conf"]=null==e[16]?0:e[16],this["pulse-region-conf"]=null==e[17]?0:e[17],this["pulse-city-conf"]=null==e[18]?0:e[18],this["pulse-postal-conf"]=null==e[19]?0:e[19],this["pulse-gmt-offset"]=null==e[20]?0:e[20],this["pulse-in-dst"]=null==e[21]?"?":e[21]}function M(t,e){this["trans-id"]=null==t?"?":t[1],this.ip=null==t?"?":t[2],this["pulse-plus-country"]=null==e[0]?"?":e[0],this["pulse-plus-region"]=null==e[1]?"?":e[1],this["pulse-plus-city"]=null==e[2]?"?":e[2],this["pulse-plus-conn-speed"]=null==e[3]?"?":e[3],this["pulse-plus-conn-type"]=null==e[4]?"?":e[4],this["pulse-plus-metro-code"]=null==e[5]?0:e[5],this["pulse-plus-latitude"]=null==e[6]?0:e[6],this["pulse-plus-longitude"]=null==e[7]?0:e[7],this["pulse-plus-postal-code"]=null==e[8]?"?":e[8],this["pulse-plus-postal-ext"]=null==e[9]?"?":e[9],this["pulse-plus-country-code"]=null==e[10]?0:e[10],this["pulse-plus-region-code"]=null==e[11]?0:e[11],this["pulse-plus-city-code"]=null==e[12]?0:e[12],this["pulse-plus-continent-code"]=null==e[13]?0:e[13],this["pulse-plus-two-letter-country"]=null==e[14]?"?":e[14],this["pulse-plus-internal-code"]=null==e[15]?0:e[15],this["pulse-plus-area-codes"]=null==e[16]?"?":e[16],this["pulse-plus-country-conf"]=null==e[17]?0:e[17],this["pulse-plus-region-conf"]=null==e[18]?0:e[18],this["pulse-plus-city-conf"]=null==e[19]?0:e[19],this["pulse-plus-postal-conf"]=null==e[20]?0:e[20],this["pulse-plus-gmt-offset"]=null==e[21]?0:e[22],this["pulse-plus-in-dst"]=null==e[22]?"?":e[22]}b.isValidDatabaseId=function(t){for(var e in _)if(_.hasOwnProperty(e)&&_[e]==t)return!0;return!1},b.isValidApiId=function(t){return x.isInt(t,{min:0,max:127})},b.isValidDelay=function(t){return x.isInt(t)},b.determineIpType=function(t){var e;return x.isIP(t,4)?e=4:x.isIP(t,6)&&(e=6),e},b.generateResponseObject=function(t,e,n){var r;switch(t[0]){case 3:r=new A(t,e);break;case 4:r=new E(t,e);break;case 5:r=new $(t,e);break;case 6:r=new R(t,e);break;case 7:r=new C(t,e);break;case 8:r=new O(t,e);break;case 9:r=new j(t,e);break;case 10:r=new I(t,e);break;case 11:r=new S(t,e);break;case 12:r=new k(t,e);break;case 14:r=new T(t,e);break;case 15:r=new z(t,e);break;case 17:r=new N(t,e);break;case 18:r=new P(t,e);break;case 19:r=new L(t,e);break;case 24:r=new q(t,e);break;case 25:r=new B(t,e);break;case 26:r=new Z(t,e);break;case 30:r=new M(t,e);break;default:console.log("This should not happen.")}return r},b.generateXMLResponseObject=function(t,e,n){var r=t.response.$;if(r["trans-id"]==e){for(var i in r)"error"===i&&"DB Not Loaded"===r[i]&&delete r[i];n(r)}else{n("Error : response transaction id does not match request transaction id.")}},b.showError=function(t,e){var n;return n=t&&D[t]?D[t]:D.ERROR,e&&(n=n.replace("%s",e)),n},b.showResult=function(t){return t};var U=t,Y=w,V=b;f.queryNetAcuityServer=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t[0],r=t[1],i=t[2],u=t[3],o=t[4],a=V.determineIpType(u);return new Promise((function(t,l){if(V.isValidDatabaseId(n)&&V.isValidApiId(r)&&null!=a&&null!=V.determineIpType(u)&&V.isValidDelay(o)){var s=4===a?U.createSocket("udp4"):U.createSocket("udp6"),c=Y.generate({length:10,charset:"alphanumeric"}),f=n+";"+r+";"+i+";5;12;"+c+";",d=Buffer.from(f),p=setTimeout((function(t){return s.close(),l(t?V.showError("SERVICE_ERROR",t):V.showError("TIMEOUT",c))}),o);s.on("message",(function(r){s.close(),clearTimeout(p);var u=r.toString();if(e)return t(V.showResult(u));for(var o=u.split(";"),a=0;o[a]!=c&&a<o.length;)a++;if(a>=o.length-1)return l(V.showError("IDENTIFY_ERROR"));if(""==o[a+1]){var f=o.slice(a+2,o.length-1),d=[n,c,i],h=V.generateResponseObject(d,f);return t(h)}return l(V.showError("SERVICE_ERROR","Error: ".concat(o[a+1])))})),s.send(d,0,d.length,5400,u,(function(t){if(t)return l(V.showError("SERVICE_ERROR",t))}))}else l(V.showError("PARAM_ERROR",err))}))};var W=c,H=f;function Q(t){return"[object Object]"===Object.prototype.toString.call(t)}function X(t,e){return J.apply(this,arguments)}function J(){return(J=r(regeneratorRuntime.mark((function t(e,n){var r,i,u,o,a,l,s,c,f,d,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Q(n)){t.next=2;break}throw new TypeError("Options must be an object!");case 2:if(r=n.databaseType,i=void 0===r?3:r,u=n.apiId,o=void 0===u?64:u,a=n.netAcuityIp,l=n.timeoutDelay,s=void 0===l?2e3:l,c=n.rawBoolean,f=void 0!==c&&c,a){t.next=5;break}throw new Error("NetAcuityIp must be exist!");case 5:return d=W.getClientIp(e),p=[i,o,d,a,s],t.prev=7,t.next=10,H.queryNetAcuityServer(p,f);case 10:return t.abrupt("return",t.sent);case 13:throw t.prev=13,t.t0=t.catch(7),new Error(t.t0);case 16:case"end":return t.stop()}}),t,null,[[7,13]])})))).apply(this,arguments)}var G={getClientInfo:X,mw:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Q(t))throw new TypeError("Options must be an object!");var e=t.attributeName||"clientInfo";return function(){var n=r(regeneratorRuntime.mark((function n(r,i,u){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,X(r,t);case 2:o=n.sent,Object.defineProperty(r,e,{get:function(){return o},configurable:!0}),u();case 5:case"end":return n.stop()}}),n)})));return function(t,e,r){return n.apply(this,arguments)}}()}};export{G as default};
